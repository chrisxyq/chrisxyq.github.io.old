---
layout: post
title: 线程死锁示例
catalog: true
tags:
    - Java并发编程

---



### 线程死锁示例1

一人一只筷子

![1596812920164](https://gitee.com/chrisxyq/picgo/raw/master/img/1596812920164.png)

![1596812990231](https://gitee.com/chrisxyq/picgo/raw/master/img/1596812990231.png)

在两个锁之间加上sleep，以增大死锁概率

![1596813075985](https://gitee.com/chrisxyq/picgo/raw/master/img/1596813075985.png)

### 线程死锁示例2

线程任务类的构造函数

![image-20210728111021974](https://gitee.com/chrisxyq/picgo/raw/master/https://gitee.com/chrisxyq/image-20210728111021974.png)

**线程任务类的run方法：加两个锁**

![image-20210728111044038](https://gitee.com/chrisxyq/picgo/raw/master/https://gitee.com/chrisxyq/image-20210728111044038.png)

**测试方法：start****方法两个线程**

![image-20210728111105979](https://gitee.com/chrisxyq/picgo/raw/master/https://gitee.com/chrisxyq/image-20210728111105979.png)

### **死锁排查：windows：jps –l和jstack** 

定位故障进程编号：**jps –l**

查看java进程的栈信息：jstack 进程编号（返回是否出现死锁）